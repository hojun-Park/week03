<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,height=device=height,initial-scale=1, user-scalable=no">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>INHAstudy</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500&display=swap" rel="stylesheet">
    <style>
        .createRoomModal_text1 {
            font-size: 30px;
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
            margin: auto;
        }

        .createRoomModal_text2 {
            font-size: 25px;
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
            margin-bottom: -25px;
        }

        .createRoomModal_text3 {
            font-size: 20px;
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .createRoomModal_text4 {
            width: 26px;
            font-size: 20px;
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .createRoomModal_background {
            background: #7f9dff;
        }

        .check_margin {
            margin-bottom: 15px;
        }

        .modal-content {
            overflow-y: initial !important;
            border: 2px solid white;
            border-radius: 20px;
        }

        .modal-body {
            height: 600px;
            overflow-y: auto;
        }

        .row {
            margin-bottom: 20px;
        }

        .color1 {
            background: brown;
        }

        .studyPlanModal_text1{
            font-size: 30px;
            color: black;
            font-family: 'Noto Sans KR', sans-serif;
            margin: auto;
        }
        .studyPlanModal_text2{
            font-size: 25px;
            color: lightslategray;
            font-family: 'Noto Sans KR', sans-serif;
            margin-bottom: -25px;
        }
        .studyPlanModal_text3{
            font-size: 25px;
            color: black;
            font-family: 'Noto Sans KR', sans-serif;
            margin-top: 20px;
        }
        .studyPlanModal_text4 {
            width: 26px;
            font-size: 20px;
            color: black;
            font-family: 'Noto Sans KR', sans-serif;
            margin-top: 20px;

        }
        .studyPlanModal_background{
            background: #fff;
        }

    </style>

    <script>
        function maxPeople(el, max) {
            if (el.value > max) {
                alert("최대 인원 수는 100명입니다.");
                el.value = " ";
            }
        }

        function activityTime(el, max) {
            if (el.value > max) {
                alert("소요 시간은 최대 24시간까지 가능합니다.");
                el.value = " ";
            }
        }

        function writeRoom() {
            let room_title = $(`#room_title`).val();
            let re_start_date = $(`#re_start_date`).val();
            let re_end_date = $(`#re_end_date`).val();
            let category = $(`#category`).val();
            let max_join = $(`#max_join`).val();
            let ac_start_date = $(`#ac_start_date`).val();
            let ac_end_date = $(`#ac_end_date`).val();
            let location = $(`#location`).val();
            let study_count = $(`#study_count`).val();
            let study_time = $(`#study_time`).val();
            let active_type = $(`input[name=active_type]:checked`).val();
            let info = $(`#info`).val();

            console.log(active_type);

            let data = {
                'roomTitle': room_title,
                'reStartDate': re_start_date,
                'reEndDate': re_end_date,
                'category': category,
                'maxJoin': max_join,
                'acStartDate': ac_start_date,
                'acEndDate': ac_end_date,
                'location': location,
                'studyCount': study_count,
                'studyTime': study_time,
                'activeType': active_type,
                'info': info
            };

            $.ajax({
                type: "POST",
                url: "/api/rooms",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function (response) {
                    alert('방이 성공적으로 생성되었습니다.');
                    window.location.reload();
                }
            })
        }

        $(document).ready(function () {
            getRoom();
        });

        function getRoom() {
            $.ajax({
                type: "GET",
                url: "/api/rooms",
                success: function (response) {
                    let message=response[0];
                    let roomTitle=message['roomTitle'];
                    let reStartDate = message['reStartDate'];
                    let reEndDate = message['reEndDate'];
                    let category = message['category'];
                    let curJoin = message['curJoin'];
                    let maxJoin = message['maxJoin'];
                    let acStartDate = message['acStartDate'];
                    let acEndDate = message['acEndDate'];
                    let location = message['location'];
                    let studyCount = message['studyCount'];
                    let studyTime = message['studyTime'];
                    let activeType = message['activeType'];
                    let info=message['info'];
                    addHTML(roomTitle, reStartDate, reEndDate, category, curJoin, maxJoin, acStartDate, acEndDate, location, studyCount, studyTime, activeType, info);

                }
            })
        }


        function addHTML(roomTitle, reStartDate, reEndDate, category, curJoin, maxJoin, acStartDate, acEndDate, location, studyCount, studyTime, activeType, info) {
            // 1. HTML 태그를 만듭니다.
            let tempHtml = `<div class="card" style="width: 18rem;">
  <div class="card-body">
    <h5 class="card-title">${roomTitle}</h5>
    <p class="card-text">${info}</p>
    <button type="button" class="btn btn-primary color1" data-bs-toggle="modal" data-bs-target="#studyPlan"
        data-bs-whatever="@mdo">스터디 계획서
</button>
<div class="modal fade" id="studyPlan" tabindex="-1" aria-labelledby="studyPlanLabel" aria-hidden="true"
     data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content studyPlanModal_background">
            <div class="modal-header">
                <h5 class="modal-title studyPlanModal_text1" id="studyPlanLabel">* 스터디 계획서 *</h5>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="room_title" class="col-form-label studyPlanModal_text2">방 제목</label>
                        <p class="studyPlanModal_text3">${roomTitle}</p>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label studyPlanModal_text2">모집 기간</label>
                        <p class="studyPlanModal_text3">${reStartDate}   ~   ${reEndDate}</p>
                    </div>
                    <div class="mb-3">
                        <label for="category" class="col-form-label studyPlanModal_text2">카테고리</label>
                        <p class="studyPlanModal_text3">${category}</p>
                    </div>
                    <div class="mb-3">
                        <label for="max_join" class="col-form-label studyPlanModal_text2">최대 입장 인원</label>
                        <p class="studyPlanModal_text3">${maxJoin}명</p>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label studyPlanModal_text2">활동 기간</label>
                        <p class="studyPlanModal_text3">${acStartDate}   ~   ${acEndDate}</p>
                    </div>
                    <div class="mb-3">
                        <label for="location" class="col-form-label studyPlanModal_text2">활동 장소</label>
                        <p class="studyPlanModal_text3">${location}</p>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label studyPlanModal_text2">활동 시간</label>
                            <p class="studyPlanModal_text3">${studyCount}   /   ${studyTime}시간</p>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label studyPlanModal_text2">활동 유형</label>
                        <p class="studyPlanModal_text3">${activeType}</p>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label studyPlanModal_text2">활동 소개</label>
                        <p class="studyPlanModal_text3">${info}</p>
                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>

        </div>
    </div>
</div>
  </div>
</div>`;
                            $('#cards').append(tempHtml);
        }
    </script>
</head>

<body>


<button type="button" class="btn btn-primary color1" data-bs-toggle="modal" data-bs-target="#makeRoom"
        data-bs-whatever="@mdo">방 생성
</button>

<div class="modal fade" id="makeRoom" tabindex="-1" aria-labelledby="makeRoomLabel" aria-hidden="true"
     data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content createRoomModal_background">
            <div class="modal-header">
                <h5 class="modal-title createRoomModal_text1" id="makeRoomLabel">INHA STUDY</h5>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="room_title" class="col-form-label createRoomModal_text2">방 제목</label>
                        <input type="text" class="form-control" id="room_title" placeholder="최대 50자" maxlength="50"
                               required>
                    </div>
                    <div class="row g-3">
                        <label class="col-form-label createRoomModal_text2">모집 기간</label>
                        <div class="col">
                            <input type="date" class="form-control" id="re_start_date" placeholder="시작 일자"
                                   aria-label="re_start_date" required>
                        </div>
                        <p class="createRoomModal_text4">~</p>
                        <div class="col">
                            <input type="date" class="form-control" id="re_end_date" placeholder="종료 일자"
                                   aria-label="re_end_date" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="category" class="col-form-label createRoomModal_text2">카테고리</label>
                        <select class="form-select" id="category" aria-label="Default select example" required>
                            <option selected>카테고리</option>
                            <option value="전공 스터디">전공 스터디</option>
                            <option value="취업 스터디">취업 스터디</option>
                            <option value="자율 스터디">자율 스터디</option>
                            <option value="기타">기타</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="max_join" class="col-form-label createRoomModal_text2">최대 입장 인원</label>
                        <input type="number" class="form-control" id="max_join" oninput='maxPeople(this, 100)'
                               placeholder="최대 인원 100명" required>
                    </div>
                    <div class="row g-3">
                        <label class="col-form-label createRoomModal_text2">활동 기간</label>
                        <div class="col">
                            <input type="date" class="form-control" id="ac_start_date" date-placeholder="시작 일자"
                                   aria-label="ac_start_date" required>
                        </div>
                        <p class="createRoomModal_text4">~</p>
                        <div class="col">
                            <input type="date" class="form-control" id="ac_end_date" date-placeholder="종료 일자"
                                   aria-label="ac_end_date" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="location" class="col-form-label createRoomModal_text2">활동 장소</label>
                        <input type="text" class="form-control" id="location" placeholder="최대 50자" maxlength="50"
                               required>
                    </div>
                    <div class="row g-3">
                        <label class="col-form-label createRoomModal_text2">활동 시간</label>
                        <div class="col">
                            <select class="form-select" id="study_count" aria-label="Default select example" required>
                                <option selected>스터디 횟수</option>
                                <option value="주 1회">주 1회</option>
                                <option value="주 2회">주 2회</option>
                                <option value="주 3회">주 3회</option>
                                <option value="주 4회">주 4회</option>
                                <option value="주 5회">주 5회</option>
                                <option value="주 6회">주 6회</option>
                                <option value="주 7회">주 7회</option>
                            </select>
                        </div>
                        <div class="col">
                            <input type="number" class="form-control" id="study_time" placeholder="소요 시간(숫자만 입력)"
                                   oninput='activityTime(this, 24)' aria-label="time" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label createRoomModal_text2">활동 유형</label>
                        <div class="check_margin"></div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="active_type" id="online" value="온라인"
                                   checked>
                            <label class="form-check-label createRoomModal_text3" for="online">
                                온라인
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="active_type" id="offline" value="오프라인">
                            <label class="form-check-label createRoomModal_text3" for="offline">
                                오프라인
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="active_type" id="blended" value="블렌디드">
                            <label class="form-check-label createRoomModal_text3" for="blended">
                                블렌디드
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="col-form-label createRoomModal_text2">활동 소개</label>
                        <textarea rows="10" cols="10" class="form-control" id="info"
                                  placeholder="ex) 세부 활동 내용"></textarea>
                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="writeRoom()">생성</button>
                </div>
            </div>

        </div>
    </div>
</div>


<div id="cards"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>
</html>

